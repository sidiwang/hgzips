% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/ZINB_one_gamma.R
\name{ZINB_one_gamma}
\alias{ZINB_one_gamma}
\title{Zero-Inflated Negative Binomial - One Gamma Component}
\usage{
ZINB_one_gamma(
  alpha,
  beta,
  omega,
  N,
  E,
  weight,
  iteration,
  Loglik = FALSE,
  zeroes = FALSE,
  N_star = 1
)
}
\arguments{
\item{alpha}{initial shape parameter value of the gamma distribution for implementing the EM algprithm}

\item{beta}{initial rate parameter value of the gamma distribution for implementing the EM algprithm}

\item{omega}{initial weight for observing a true zero (according to zero-inflated poission distribution)}

\item{N}{vector of Nij values}

\item{E}{vector of Eij values}

\item{weight}{set weight = rep(1, length(N)) if N and E are not squashed data, or input the weight vector corresponding to the squashed Nij vector.}

\item{iteration}{number of EM algorithm iterations to run}

\item{Loglik}{whether to return the loglikelihood of each iteration or not (TRUE or FALSE)}

\item{zeroes}{A logical scalar specifying if zero counts should be included.}

\item{N_star}{the minimum Nij count size to be used for hyperparameter estimation. If zeroes are included in Nij vector, please set N_star = NULL}
}
\value{
a list including the following:
if Nij = 0 is included in the input dataset
\itemize{
\item \code{theta_EM} Estimate of hyperparameters for each EM iteration
\item \code{llh} logliklihood for each EM iteration (optional)
}
if the minimum Nij count size included in the input dataset is not 0"
\itemize{
\item \code{alpha} Estimated alpha value
\item \code{beta} Estimated beta value
\item \code{omega} is not exported because the value of \code{omega} doesn't affect the estimation of \code{lambda}
}
}
\description{
This \code{ZINB_one_gamma} function finds hyperparameter estimates by implementing the Expectation-Maximization (EM) algorithm and zero-inflated negative binomial model with one gamma component. \code{nlminb} function is used to maximize the loglikelihood function.
}
\examples{
Nij = rnbinom(100, size = 2, prob = 0.3)
Eij = runif(100, 0, 2)
par_estimated = ZINB_one_gamma(0.2, 0.1, 0.33, Nij, Eij, rep(1, length(Nij)), iteration = 10, Loglik = TRUE, zeros = TRUE, N_star = 1)
par_estimated$theta_EM
par_estimated$Loglik


}
\seealso{
openEBGM, nlminb
}
