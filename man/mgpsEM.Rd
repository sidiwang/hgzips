% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/mgpsEM.R
\name{mgpsEM}
\alias{mgpsEM}
\title{Multi-Item Gamma-Poisson Shrinker (MGPS)}
\usage{
mgpsEM(
  alpha1,
  beta1,
  alpha2,
  beta2,
  pi,
  N,
  E,
  weight,
  iteration,
  Loglik = FALSE,
  zeroes = FALSE,
  N_star = 1
)
}
\arguments{
\item{alpha1}{initial shape parameter guess of the first gamma distribution}

\item{beta1}{initial rate parameter guess of the first gamma distribution}

\item{alpha2}{initial shape parameter guess of the second gamma distribution}

\item{beta2}{initial rate parameter guess of the second gamma distribution}

\item{pi}{initial mixing proportion guess of the two gamma distributions}

\item{N}{vector of Nij values}

\item{E}{vector of Eij values}

\item{weight}{set weight = rep(1, length(N)) if N and E are not squashed data, or input the weight vector corresponding to the squashed Nij vector.}

\item{iteration}{number of EM algorithm iterations to run}

\item{Loglik}{whether to return the loglikelihood of each iteration or not (TRUE or FALSE)}

\item{zeroes}{A logical scalar specifying if zero counts should be included.}

\item{N_star}{the minimum Nij count size to be used for hyperparameter estimation. If zeroes are included in Nij vector, please set N_star = NULL}
}
\value{
a list including the following:
\itemize{
\item \code{theta_EM} Estimate of hyperparameters for each EM iteration
\item \code{llh} logliklihood for each EM iteration (optional)
}
}
\description{
This \code{mgpsEM} function finds hyperparameter estimates by implementing the Expectation-Maximization (EM) algorithm.\code{nlminb} function is used to maximize the loglikelihood function.
}
\examples{
Nij = rnbinom(100, size = 2, prob = 0.3)
Eij = runif(100, 0, 2)
par_estimated = mgpsEM(2, 4, 0.2, 0.1, 0.33, Nij, Eij, rep(1, length(Nij)), iteration = 10, Loglik = TRUE, zeros = TRUE, N_star = 1)
par_estimated$theta_EM
par_estimated$Loglik


}
\references{
DuMouchel W (1999). "Bayesian Data Mining in Large Frequency Tables, With an Application to the FDA Spontaneous Reporting System." The American Statistician, 53(3), 177-190.
}
\seealso{
openEBGM, nlminb
}
